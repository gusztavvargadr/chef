version: '3'

services:
  chef:
    build:
      context: ./build/docker/
      dockerfile: ./chef.Dockerfile
    volumes:
      - ./:/opt/docker/
      - ./.chef-workstation/:/root/.chef-workstation/

  chocolatey:
    build:
      context: ./build/docker/
      dockerfile: ./chocolatey.Dockerfile
    volumes:
      - ./:C:/opt/docker/

  chef-client-linux:
    build:
      context: ./build/docker/
      dockerfile: ./chef-client-linux.Dockerfile
    volumes:
      - ./:/opt/docker/

  chef-client-windows:
    build:
      context: ./build/docker/
      dockerfile: ./chef-client-windows.Dockerfile
    volumes:
      - ./:C:/opt/docker/

  chef-policy:
    build:
      context: ./
      dockerfile: ./build/docker/chef-policy.Dockerfile
      args:
        directory: core
        policy: init
    volumes:
      - ./.chef/:/opt/docker/.chef/

  chocolatey-package:
    build:
      context: ./
      dockerfile: ./build/docker/chocolatey-package.Dockerfile
      args:
        directory: core
        policy: init
    volumes:
      - ./.chef/:C:/opt/docker/.chef/
      - ./.chocolatey/:C:/opt/docker/.chocolatey/
